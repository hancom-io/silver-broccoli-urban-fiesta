---
title: "COM 그리고 한글 컨트롤"
author: 윤명
author_id: hnc-myoon
tag:
- COM
- Automation
- ActiveX
- 한글
excerpt: ActvieX란 무엇인지 알아보자.
---

## COM 그리고 자동화(Automation)

***

<br>

ActiveX에 대해서 말하기 전에 우선 COM과 자동화(Automation)에 대해서 간단히 말해야 할 것 같다. 우선 COM 이란 Component Object Model의 약자로 프로그램을 컴포넌트화 즉 부품화해서 필요한 부품들을 가져다 새로운 프로그램을 만들 수 있게 하려고 나오게 된 스펙이며 자동화는 이 COM 기반의 객체를 통해 프로그램의 내부 기능을 외부에 인터페이스를 통해 노출하는 기술을 말한다.
자동화는 아웃 오브 프로세스 서버로 동작을 하게 되는데 아웃 오브 프로세스 서버란 클라이언트와 서버(COM 컴포넌트)가 각각 별도의 프로세스에서 동작하는 경우이다. 이때 서버와 클라이언트는 약속된 계약인 인터페이스를 통하여 프로세스 간 소통을 하게 된다. 조금 더 자세히 말하자면 인터페이스 정의 파일인  idl 파일을 midl 컴파일러가 컴파일하게 되면 형식 라이브러리 파일(TLB파일)과 프록시/스텁 코드가 생성이 되게 되는데 이 프록시/스텁 코드를 로드하여 클라이언트의 프록시와 서버의 스텁에서 서로 통신을 하여 프로세스 간에 정보를 교환할 수 있게 한다. 자동화도 이러한 방식으로 동작하게 되는데 조금 다른 점이 있다면 프록시/스텁 코드를 이용해서 마샬링을 하는 일반적인 경우와 달리 자동화를 이용하게 되면 마샬링을 운영체제의 COM 라이브러리에서 제공하여 프록시/스텁 코드가 필요하지 않다는 것이다.

![아웃 오브 프로세스]({{site.assets}}/2021/2021-07-07-out-of-process.jpg)

> COM 컴포넌트란 COM 객체가 포함되어 실행되는 DLL의 인스턴스이다.

## 자동화와 ActiveX Control 의 예

***

<br>

자동화의 대표적인 예로는 마이크로소프트의 엑셀과 한컴오피스 한셀의 VBA, 아래아 한글의 스크립트가 있다. 한셀의 예를 들어 설명하자면 자동화란 한셀의 셀 선택 기능을 자동화 API로 열어 놓아 VBA를 통해 한셀의 셀 선택 기능을 제어할 수 있게 해 주는 기술이다. 액티브 엑스는 자동화 개체와 비슷한 개념인데 기술적으로 말하자면 ActiveX는 인-프로세스 서버로 동작하는 자동화 개체와 비슷하다고 볼 수 있다. 다른 점이 있다면 그래픽 인터페이스를 제공한다는 것이다. 인-프로세스 서버란 서버와 클라이언트가 같은 프로세스에서 동작하는 경우를 말한다.  반대되는 개념은 아웃 오브 프로세스 서버이다. 

<br>

![ActiveX]({{site.assets}}/2021/2021-07-07-activex.jpg){: width="500"}

> 출처 : 위키피디아

그렇다면 왜 자동화 이외에 액티브엑스가 존재하는가?  우선 한글과컴퓨터의 한셀을 생각해보면 한셀은 자동화를 통하여 C#등으로 프로그램을 작성하여 한셀을 컨트롤 할 수 있다. 하지만 ActiveX로도 동작하게 할 수 있는데 아마도 이는 ActiveX가 자동화보다 동작이 빠르다는 장점도 한 가지 이유가 되리라 생각한다. 앞서 말했듯이 자동화는 아웃 오브 프로세스로 동작하는데 프로세스 간 소통을 해야 하기 때문에 하나의 프로세스로 동작하는 ActiveX보다 속도가 느릴 수밖에 없다. 한글의 경우에도 마찬가지이다. 한글도 자동화를 통해서 MFC나 C#에서 제어가 가능하지만 외부 업체에서 프로그램을 개발할 때는 ActiveX 컨트롤을 이용해서 개발을 진행한다. 

<br>

또 다른 가장 큰 이유는 액티브엑스 컨트롤은 껍데기(컨트롤 컨테이너)에 임베딩 되어 하나의 프로그램처럼 동작할 수 있고 이 껍데기는 어떤 액티브 엑스 컨트롤이든 담을 수 있다는 장점이 있기 때문이다. 또한, 액티브 엑스 컨트롤은 가능한 어떤 껍데기에도 담길 수 있다. MFC, C#, 인터넷 익스플로러 등 활용 방법이 다양하다. 심지어 JNI를 통해 윈도우 진영이 아닌 자바에서조차 동작이 가능하게 할 수 있다. 이들 중 대표적인 껍데기로 마이크로소프트의 인터넷 익스플로러를 예로 들 수 있는데 플러그인 개념으로 익스플로러에서 액티브 엑스 프로그램을 설치하게 되면 익스플로러 상에서 그 프로그램을 마치 인터넷 브라우저처럼 사용할 수 있게 된다. 물론 많은 시간이 지나게 되면서 액티브엑스의 성능상 불편함이나 보안상의 문제점이 제기되었고 윈도우 기반 기술이다 보니 웹브라우저는 익스플로러에서만 사용이 가능하다는 단점이 있지만, 이 기술이 태어난 배경을 보게 되면 어느 껍데기에나 붙어서 동작하는 프로그램이라는 가장 큰 장점이 있기 때문에 아직 한글과컴퓨터의 한글 컨트롤이 많이 사용되고 있지 않나 라는 생각이 든다.

## 한글 컨트롤

***

<br>

![한글 컨트롤 삽입]({{site.assets}}/2021/2021-07-07-visual-studio.jpg)

> 한글 컨트롤을 WinForm에 삽입하는 모습

마지막으로 한글 컨트롤에 대해서 간략하게 설명해 보려고 한다. 한글 컨트롤은 OCX 확장자를 가지고 있는데 한글 컨트롤을 사용하는 방법은 비주얼스튜디오에서 .ocx 파일을 참조하도록 한 뒤 컨트롤 탭에서 드래그하여 WinForm위에 올려놓으면 된다. 그 다음 소스 코드에서 한글 컨트롤 객체를 선언하여 구현된 API를 사용하면 되는데 API 사용 방법은 크게 3가지이다. 구현된 함수를 이용하는 방법과 Run 함수를 이용하여 원하는 액션을 실행시키는 방법과 마지막으로 액션을 만들어서 그 액션을 Execute 시키는 방법이 있다. 이때 액션이란 프로그램상에서 사용자가 하나의 동작을 실행시키는 단위를 말한다. 액션을 만들 때는 Parameter Set 이라는 개체가 있는데 이는 문자 그대로 인자들의 집합이다. 이런 개체가 존재하는 이유는 함수에 일일이 매개변수를 전달하려면 함수를 호출하기가 매우 번거롭기 때문에 자료구조를 만들어 통째로 전달하기 위함이다. 자세한 내용은 한글과컴퓨터 홈페이지에 가면 확인할 수 있다. 이상으로 이번 포스팅을 마치며 이 글을 읽는 사람의 COM과 오토메이션, 그리고 ActiveX에 대한 이해도가 높아졌기를 바란다.
